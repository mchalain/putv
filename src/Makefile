ifeq ($(DECODER),)
	ifeq ($(DECODER_PASSTHROUGH),y)
		DECODER=decoder_passthrough
	endif
	ifeq ($(DECODER_FLAC),y)
		DECODER=decoder_flac
	endif
	ifeq ($(DECODER_MAD),y)
		DECODER=decoder_mad
	endif
endif

bin-y+=$(PUTV)
$(PUTV)_SOURCES+=main.c
$(PUTV)_SOURCES+=player.c
$(PUTV)_SOURCES+=jitter_sg.c
$(PUTV)_SOURCES+=jitter_ring.c
$(PUTV)_LIBRARY+=pthread
$(PUTV)_CFLAGS-$(SAMPLERATE_AUTO)+=-DSAMPLERATE_AUTO -DDEFAULT_SAMPLERATE=44100
$(PUTV)_CFLAGS-$(SAMPLERATE_44100)+=-DDEFAULT_SAMPLERATE=44100
$(PUTV)_CFLAGS-$(SAMPLERATE_48000)+=-DDEFAULT_SAMPLERATE=48000
$(PUTV)_SOURCES+=media_common.c
$(PUTV)_SOURCES+=src_common.c
$(PUTV)_SOURCES+=decoder_common.c

$(PUTV)_SOURCES+=filter_pcm.c
$(PUTV)_CFLAGS-$(FILTER_SCALING)+=-DFILTER_SCALING
$(PUTV)_CFLAGS-$(FILTER_MIXED)+=-DFILTER_MIXED
$(PUTV)_CFLAGS-$(FILTER_ONECHANNEL)+=-DFILTER_ONECHANNEL

$(PUTV)_SOURCES-$(MEDIA_SQLITE)+=media_sqlite.c
$(PUTV)_LIBRARY-$(MEDIA_SQLITE)+=sqlite3
$(PUTV)_CFLAGS-$(MEDIA_SQLITE)+=-DMEDIA_SQLITE
$(PUTV)_CFLAGS-$(MEDIA_SQLITE_EXT)+=-DMEDIA_SQLITE_EXT
$(PUTV)_LIBRARY-$(MEDIA_SQLITE_EXT)+=jansson
$(PUTV)_SOURCES-$(MEDIA_FILE)+=media_file.c
$(PUTV)_CFLAGS-$(MEDIA_FILE)+=-DMEDIA_FILE
$(PUTV)_CFLAGS-$(MEDIA_FILE_LIST)+=-DMEDIA_FILE_LIST
$(PUTV)_SOURCES-$(MEDIA_DIR)+=media_dir.c
$(PUTV)_CFLAGS-$(MEDIA_DIR)+=-DMEDIA_DIR
$(PUTV)_SOURCES-$(HEARTBEAT)+=heartbeat_samples.c
$(PUTV)_CFLAGS-$(HEARTBEAT)+=-DHEARTBEAT
$(PUTV)_LIBRARY-$(HEARTBEAT)+=rt
$(PUTV)_SOURCES-$(SRC_FILE)+=src_file.c
$(PUTV)_CFLAGS-$(SRC_FILE)+=-DSRC_FILE
$(PUTV)_CFLAGS-$(SRC_FILE)+=-DSRC=src_file
$(PUTV)_SOURCES-$(SRC_ALSA)+=src_alsa.c
$(PUTV)_CFLAGS-$(SRC_ALSA)+=-DSRC_ALSA
$(PUTV)_CFLAGS-$(SRC_ALSA)+=-DSRC=src_alsa
$(PUTV)_LIBRARY-$(SRC_ALSA)+=asound
$(PUTV)_SOURCES-$(SRC_CURL)+=src_curl.c
$(PUTV)_CFLAGS-$(SRC_CURL)+=-DSRC_CURL
#$(PUTV)_CFLAGS-$(SRC_CURL)+=-DCURL_DUMP
$(PUTV)_LIBRARY-$(SRC_CURL)+=curl
$(PUTV)_SOURCES-$(SRC_UNIX)+=src_unix.c
$(PUTV)_CFLAGS-$(SRC_UNIX)+=-DSRC_UNIX
$(PUTV)_CFLAGS+=-DDECODER=$(DECODER)
$(PUTV)_SOURCES-$(DECODER_PASSTHROUGH)+=decoder_passthrough.c
$(PUTV)_CFLAGS-$(DECODER_PASSTHROUGH)+=-DPASSTHROUGH
$(PUTV)_SOURCES-$(DECODER_MAD)+=decoder_mad.c
$(PUTV)_CFLAGS-$(DECODER_MAD)+=-DDECODER_MAD
$(PUTV)_LIBRARY-$(DECODER_MAD)+=mad
$(PUTV)_SOURCES-$(DECODER_FLAC)+=decoder_flac.c
$(PUTV)_CFLAGS-$(DECODER_FLAC)+=-DDECODER_FLAC
$(PUTV)_LIBRARY-$(DECODER_FLAC)+=FLAC
$(PUTV)_SOURCES-$(ENCODER_PASSTHROUGH)+=encoder_passthrough.c
$(PUTV)_CFLAGS-$(ENCODER_PASSTHROUGH)+=-DENCODER_PASSTHROUGH
$(PUTV)_CFLAGS-$(ENCODER_PASSTHROUGH)+=-DENCODER=encoder_passthrough
$(PUTV)_CFLAGS-$(ENCODER_PASSTHROUGH)+=-DENCODER_FRAME_SIZE=1024
$(PUTV)_SOURCES-$(ENCODER_LAME)+=encoder_lame.c
$(PUTV)_CFLAGS-$(ENCODER_LAME)+=-DENCODER_LAME
$(PUTV)_CFLAGS-$(ENCODER_LAME)+=-DENCODER=encoder_lame
$(PUTV)_CFLAGS-$(ENCODER_LAME)+=-DENCODER_FRAME_SIZE=1024
#$(PUTV)_CFLAGS-$(ENCODER_LAME)+=-DLAME_DUMP
$(PUTV)_LIBRARY-$(ENCODER_LAME)+=mp3lame
$(PUTV)_SOURCES-$(SINK_ALSA)+=sink_alsa.c
$(PUTV)_CFLAGS-$(SINK_ALSA)+=-DSINK_ALSA
$(PUTV)_CFLAGS-$(SINK_ALSA)+=-DSINK_ALSA_FORMAT=$(SINK_ALSA_FORMAT)
$(PUTV)_CFLAGS-$(SINK_ALSA)+=-DSINK=sink_alsa
$(PUTV)_CFLAGS-$(SINK_ALSA_CONFIG)+=-DSINK_ALSA_CONFIG
$(PUTV)_CFLAGS-$(SINK_ALSA_MIXER)+=-DSINK_ALSA_MIXER
$(PUTV)_LIBRARY-$(SINK_ALSA)+=asound
$(PUTV)_SOURCES-$(SINK_TINYALSA)+=sink_tinyalsa.c
$(PUTV)_CFLAGS-$(SINK_TINYALSA)+=-DSINK_TINYALSA
$(PUTV)_CFLAGS-$(SINK_TINYALSA)+=-DSINK_ALSA_FORMAT=$(SINK_ALSA_FORMAT)
$(PUTV)_CFLAGS-$(SINK_TINYALSA)+=-DSINK=sink_tinyalsa
$(PUTV)_LIBRARY-$(SINK_TINYALSA)+=tinyalsa
$(PUTV)_SOURCES-$(SINK_FILE)+=sink_file.c
$(PUTV)_CFLAGS-$(SINK_FILE)+=-DSINK_FILE
$(PUTV)_CFLAGS-$(SINK_FILE)+=-DSINK=sink_file
$(PUTV)_SOURCES-$(SINK_UNIX)+=sink_unix.c
$(PUTV)_SOURCES-$(SINK_UNIX)+=unix_server.c
$(PUTV)_CFLAGS-$(SINK_UNIX)+=-DSINK_UNIX
$(PUTV)_CFLAGS-$(SINK_UNIX)+=-DSINK=sink_unix
$(PUTV)_CFLAGS-$(SINK_UNIX)+=-DMAX_CLIENTS=10
$(PUTV)_SOURCES-$(CMDLINE)+=cmds_line.c
$(PUTV)_CFLAGS-$(CMDLINE)+=-DCMDLINE
$(PUTV)_SOURCES-$(CMDINPUT)+=cmds_input.c
$(PUTV)_CFLAGS-$(CMDINPUT)+=-DCMDINPUT
$(PUTV)_CFLAGS-$(CMDINPUT)+=-DCMDINPUT_PATH=\"$(CMDINPUT_PATH)\"
$(PUTV)_CFLAGS-$(MEDIA_DIR)+=-DMEDIA_IMPORT
$(PUTV)_SOURCES-$(JSONRPC)+=cmds_json.c
$(PUTV)_SOURCES-$(JSONRPC)+=unix_server.c
$(PUTV)_CFLAGS-$(JSONRPC)+=-DJSONRPC
$(PUTV)_CFLAGS-$(JSONRPC_LARGEPACKET)+=-DJSONRPC_LARGEPACKET
$(PUTV)_LIBRARY-$(JSONRPC)+=jsonrpc jansson
$(PUTV)_CFLAGS+=-I ../lib/jsonrpc
$(PUTV)_LDFLAGS+=-L ../lib/jsonrpc
$(PUTV)_CFLAGS-$(USE_INOTIFY)+=-DUSE_INOTIFY
$(PUTV)_CFLAGS-$(USE_ID3TAG)+=-DUSE_ID3TAG
$(PUTV)_LIBRARY-$(USE_ID3TAG)+=id3tag
$(PUTV)_CFLAGS-$(USE_TIMER)+=-DUSE_TIMER
$(PUTV)_LIBRARY-$(USE_TIMER)+=rt
$(PUTV)_CFLAGS-$(USE_REALTIME)+=-DUSE_REALTIME
$(PUTV)_CFLAGS-$(USE_REALTIME)+=-DREALTIME_SCHED=SCHED_RR

$(PUTV)_CFLAGS-$(DEBUG)+=-g -DDEBUG
