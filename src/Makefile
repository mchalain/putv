ifeq ($(HEARTBEAT),)
	ifeq ($(SINK_UNIX),y)
		HEARTBEAT=y
	endif
	ifeq ($(SINK_UDP),y)
		HEARTBEAT=y
	endif
endif

PUTV?=putv

bin-y+=$(PUTV)
$(PUTV)_SOURCES+=main.c
$(PUTV)_SOURCES+=player.c
$(PUTV)_SOURCES+=jitter_sg.c
$(PUTV)_SOURCES+=jitter_ring.c
$(PUTV)_LIBRARY+=pthread
$(PUTV)_CFLAGS-$(SAMPLERATE_AUTO)+=-DSAMPLERATE_AUTO -DDEFAULT_SAMPLERATE=44100
$(PUTV)_CFLAGS-$(SAMPLERATE_44100)+=-DDEFAULT_SAMPLERATE=44100
$(PUTV)_CFLAGS-$(SAMPLERATE_48000)+=-DDEFAULT_SAMPLERATE=48000
$(PUTV)_SOURCES+=media_common.c
$(PUTV)_SOURCES+=src_common.c
$(PUTV)_SOURCES+=decoder_common.c

$(PUTV)_SOURCES+=filter_pcm.c
$(PUTV)_CFLAGS-$(FILTER_SCALING)+=-DFILTER_SCALING
$(PUTV)_CFLAGS-$(FILTER_MIXED)+=-DFILTER_MIXED
$(PUTV)_CFLAGS-$(FILTER_ONECHANNEL)+=-DFILTER_ONECHANNEL

$(PUTV)_SOURCES-$(MEDIA_SQLITE)+=media_sqlite.c
$(PUTV)_LIBRARY-$(MEDIA_SQLITE)+=sqlite3
$(PUTV)_CFLAGS-$(MEDIA_SQLITE)+=-DMEDIA_SQLITE
$(PUTV)_CFLAGS-$(MEDIA_SQLITE_EXT)+=-DMEDIA_SQLITE_EXT
$(PUTV)_LIBRARY-$(MEDIA_SQLITE_EXT)+=jansson
$(PUTV)_SOURCES-$(MEDIA_FILE)+=media_file.c
$(PUTV)_CFLAGS-$(MEDIA_FILE)+=-DMEDIA_FILE
$(PUTV)_CFLAGS-$(MEDIA_FILE_LIST)+=-DMEDIA_FILE_LIST
$(PUTV)_SOURCES-$(MEDIA_DIR)+=media_dir.c
$(PUTV)_CFLAGS-$(MEDIA_DIR)+=-DMEDIA_DIR
$(PUTV)_SOURCES-$(HEARTBEAT)+=heartbeat_samples.c
$(PUTV)_SOURCES-$(HEARTBEAT)+=heartbeat_bitrate.c
$(PUTV)_CFLAGS-$(HEARTBEAT)+=-DHEARTBEAT_COEF_1000=1000
$(PUTV)_CFLAGS-$(HEARTBEAT)+=-DHEARTBEAT
$(PUTV)_LIBRARY-$(HEARTBEAT)+=rt
$(PUTV)_SOURCES-$(SRC_FILE)+=src_file.c
$(PUTV)_CFLAGS-$(SRC_FILE)+=-DSRC_FILE
$(PUTV)_SOURCES-$(SRC_ALSA)+=src_alsa.c
$(PUTV)_CFLAGS-$(SRC_ALSA)+=-DSRC_ALSA
$(PUTV)_LIBRARY-$(SRC_ALSA)+=asound
$(PUTV)_SOURCES-$(SRC_CURL)+=src_curl.c
$(PUTV)_CFLAGS-$(SRC_CURL)+=-DSRC_CURL
#$(PUTV)_CFLAGS-$(SRC_CURL)+=-DCURL_DUMP
$(PUTV)_LIBRARY-$(SRC_CURL)+=curl
$(PUTV)_SOURCES-$(SRC_UNIX)+=src_unix.c
$(PUTV)_CFLAGS-$(SRC_UNIX)+=-DSRC_UNIX
$(PUTV)_SOURCES-$(SRC_UDP)+=src_udp.c
$(PUTV)_CFLAGS-$(SRC_UDP)+=-DSRC_UDP
#$(PUTV)_CFLAGS-$(SRC_UDP)+=-DUDP_DUMP
$(PUTV)_CFLAGS-$(SRC_UDP)+=-DUDP_THREAD
#$(PUTV)_CFLAGS-$(SRC_UDP)+=-DUDP_MARKER
$(PUTV)_SOURCES-$(DEMUX_PASSTHROUGH)+=demux_passthrough.c
$(PUTV)_CFLAGS-$(DEMUX_PASSTHROUGH)+=-DDEMUX_PASSTHROUGH
$(PUTV)_SOURCES-$(DEMUX_RTP)+=demux_rtp.c
$(PUTV)_CFLAGS-$(DEMUX_RTP)+=-DDEMUX_RTP
$(PUTV)_CFLAGS+=-DDECODER=$(DECODER)
$(PUTV)_SOURCES-$(DECODER_PASSTHROUGH)+=decoder_passthrough.c
$(PUTV)_CFLAGS-$(DECODER_PASSTHROUGH)+=-DDECODER_PASSTHROUGH
$(PUTV)_SOURCES-$(DECODER_MAD)+=decoder_mad.c
$(PUTV)_CFLAGS-$(DECODER_MAD)+=-DDECODER_MAD
$(PUTV)_LIBRARY-$(DECODER_MAD)+=mad
$(PUTV)_SOURCES-$(DECODER_FLAC)+=decoder_flac.c
$(PUTV)_CFLAGS-$(DECODER_FLAC)+=-DDECODER_FLAC
$(PUTV)_LIBRARY-$(DECODER_FLAC)+=FLAC
$(PUTV)_SOURCES-$(ENCODER_PASSTHROUGH)+=encoder_passthrough.c
$(PUTV)_CFLAGS-$(ENCODER_PASSTHROUGH)+=-DENCODER_PASSTHROUGH
$(PUTV)_CFLAGS-$(ENCODER_PASSTHROUGH)+=-DENCODER=encoder_passthrough
$(PUTV)_CFLAGS-$(ENCODER_PASSTHROUGH)+=-DENCODER_FRAME_SIZE=1024
$(PUTV)_SOURCES-$(ENCODER_LAME)+=encoder_lame.c
$(PUTV)_CFLAGS-$(ENCODER_LAME)+=-DENCODER_LAME
$(PUTV)_CFLAGS-$(ENCODER_LAME)+=-DENCODER=encoder_lame
$(PUTV)_CFLAGS-$(ENCODER_LAME)+=-DENCODER_FRAME_SIZE=1024
#$(PUTV)_CFLAGS-$(ENCODER_LAME)+=-DLAME_DUMP
$(PUTV)_LIBRARY-$(ENCODER_LAME)+=mp3lame
$(PUTV)_SOURCES-$(MUX)+=mux_common.c
$(PUTV)_SOURCES-$(MUX)+=mux_passthrough.c
$(PUTV)_CFLAGS-$(MUX)+=-DMUX
$(PUTV)_SOURCES-$(MUX_RTP)+=mux_rtp.c
$(PUTV)_CFLAGS-$(MUX_RTP)+=-DMUX_RTP
$(PUTV)_SOURCES-$(SINK_ALSA)+=sink_alsa.c
$(PUTV)_CFLAGS-$(SINK_ALSA)+=-DSINK_ALSA
$(PUTV)_CFLAGS-$(SINK_ALSA)+=-DSINK_ALSA_FORMAT=$(SINK_ALSA_FORMAT)
$(PUTV)_CFLAGS-$(SINK_ALSA)+=-DSINK=sink_alsa
$(PUTV)_CFLAGS-$(SINK_ALSA_CONFIG)+=-DSINK_ALSA_CONFIG
$(PUTV)_CFLAGS-$(SINK_ALSA_MIXER)+=-DSINK_ALSA_MIXER
$(PUTV)_LIBRARY-$(SINK_ALSA)+=asound
$(PUTV)_SOURCES-$(SINK_TINYALSA)+=sink_tinyalsa.c
$(PUTV)_CFLAGS-$(SINK_TINYALSA)+=-DSINK_TINYALSA
$(PUTV)_CFLAGS-$(SINK_TINYALSA)+=-DSINK_ALSA_FORMAT=$(SINK_ALSA_FORMAT)
$(PUTV)_CFLAGS-$(SINK_TINYALSA)+=-DSINK=sink_tinyalsa
$(PUTV)_LIBRARY-$(SINK_TINYALSA)+=tinyalsa
$(PUTV)_SOURCES-$(SINK_FILE)+=sink_file.c
$(PUTV)_CFLAGS-$(SINK_FILE)+=-DSINK_FILE
$(PUTV)_CFLAGS-$(SINK_FILE)+=-DSINK=sink_file
$(PUTV)_SOURCES-$(SINK_UDP)+=sink_udp.c
$(PUTV)_CFLAGS-$(SINK_UPD)+=-DSINK_UPD
#$(PUTV)_CFLAGS-$(SINK_UDP)+=-DUDP_DUMP
$(PUTV)_CFLAGS-$(SINK_UDP)+=-DSINK=sink_udp
$(PUTV)_SOURCES-$(SINK_UNIX)+=sink_unix.c
$(PUTV)_SOURCES-$(SINK_UNIX)+=unix_server.c
$(PUTV)_CFLAGS-$(SINK_UNIX)+=-DSINK_UNIX
$(PUTV)_CFLAGS-$(SINK_UNIX)+=-DSINK=sink_unix
$(PUTV)_CFLAGS-$(SINK_UNIX)+=-DMAX_CLIENTS=10
$(PUTV)_CFLAGS-$(SINK_UNIX_ASYNC)+=-DSINK_UNIX_ASYNC
$(PUTV)_CFLAGS-$(SINK_UNIX_WAITCLIENT)+=-DSINK_UNIX_WAITCLIENT
$(PUTV)_SOURCES-$(CMDLINE)+=cmds_line.c
$(PUTV)_CFLAGS-$(CMDLINE)+=-DCMDLINE
$(PUTV)_SOURCES-$(CMDINPUT)+=cmds_input.c
$(PUTV)_CFLAGS-$(CMDINPUT)+=-DCMDINPUT
$(PUTV)_CFLAGS-$(CMDINPUT)+=-DCMDINPUT_PATH=\"$(CMDINPUT_PATH)\"
$(PUTV)_CFLAGS-$(MEDIA_DIR)+=-DMEDIA_IMPORT
$(PUTV)_SOURCES-$(JSONRPC)+=cmds_json.c
$(PUTV)_SOURCES-$(JSONRPC)+=unix_server.c
$(PUTV)_CFLAGS-$(JSONRPC)+=-DJSONRPC
$(PUTV)_CFLAGS-$(JSONRPC_LARGEPACKET)+=-DJSONRPC_LARGEPACKET
$(PUTV)_LIBRARY-$(JSONRPC)+=jsonrpc jansson
$(PUTV)_CFLAGS+=-I ../lib/jsonrpc
$(PUTV)_LDFLAGS+=-L ../lib/jsonrpc
$(PUTV)_SOURCES-$(TINYSVCMDNS)+=cmds_tinysvcmdns.c
$(PUTV)_LIBRARY-$(TINYSVCMDNS)+=tinysvcmdns
$(PUTV)_CFLAGS-$(TINYSVCMDNS)+=-DTINYSVCMDNS
$(PUTV)_CFLAGS-$(TINYSVCMDNS)+=-DINDEX_HTML=\"$(INDEX_HTML)\"
$(PUTV)_CFLAGS-$(TINYSVCMDNS_NETIF)+=-DNETIF=\"$(NETIF)\"
$(PUTV)_CFLAGS-$(TINYSVCMDNS_NETIF2)+=-DNETIF2=\"$(NETIF2)\"
$(PUTV)_CFLAGS-$(TINYSVCMDNS)+=-I ../lib/tinysvcmdns
$(PUTV)_LDFLAGS-$(TINYSVCMDNS)+=-L ../lib/tinysvcmdns
$(PUTV)_CFLAGS-$(USE_INOTIFY)+=-DUSE_INOTIFY
$(PUTV)_CFLAGS-$(USE_ID3TAG)+=-DUSE_ID3TAG
$(PUTV)_LIBRARY-$(USE_ID3TAG)+=id3tag
$(PUTV)_CFLAGS-${USE_OGGMETADDATA}+=-DUSE_OGGMETADDATA
$(PUTV)_CFLAGS-$(USE_TIMER)+=-DUSE_TIMER
$(PUTV)_LIBRARY-$(USE_TIMER)+=rt
$(PUTV)_CFLAGS-$(USE_REALTIME)+=-DUSE_REALTIME
$(PUTV)_CFLAGS-$(USE_REALTIME)+=-DREALTIME_SCHED=SCHED_RR
$(PUTV)_CFLAGS-$(UDP_MARKER)+=-DUDP_MARKER

$(PUTV)_CFLAGS-$(DEBUG)+=-g -DDEBUG
